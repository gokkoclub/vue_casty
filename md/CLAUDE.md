Workflow Orchestration

1. Plan Node Default

  - 非自明なタスク（3ステップ以上の工程、または設計上の決定を伴うもの）では、必ずプランモード（計画策定）に入ること。
  - 進行が滞ったり問題が発生したりした場合は、即座に停止して再計画すること。無理に押し進めない。
  - 構築だけでなく、検証ステップにもプランモードを活用すること。
  - 曖昧さを排除するため、事前に詳細な仕様（スペック）を記述すること。

2. Subagent Strategy

  - メインのコンテキストウィンドウをクリーンに保つため、サブエージェントを積極的に活用すること。
  - 調査、探索、並列分析などの作業はサブエージェントにオフロード（委託）すること。
  - 複雑な問題に対しては、サブエージェントを通じて計算リソースを投入すること。
  - 実行の集中力を高めるため、1つのサブエージェントにつき1つのアプローチを割り当てること。

3. Self-Improvement Loop

  - ユーザーから修正を受けた後は、必ずそのパターンを tasks/lessons.md に更新すること。
  - 同じ間違いを繰り返さないための自分自身へのルールを記述すること。
  - ミス率が下がるまで、これらの教訓を徹底的に反復適用すること。
  - 関連プロジェクトのセッション開始時に、過去の教訓を復習すること。

4. Verification Before Done

  - 動作を証明（プルーフ）することなく、タスクを完了（Complete）とマークしないこと。
  - 必要に応じて、元の挙動と変更後の挙動の差分（Diff）を確認すること。
  - 「スタッフエンジニアならこれを承認するか？」と自問自答すること。
  - テストを実行し、ログを確認し、正当性をデモンストレーションすること。

5. Demand Elegance (Balanced)

  - 非自明な変更については、一度立ち止まって「よりエレガントな方法はないか？」と考えること。
  - 対症療法的な修正（ハッキーな修正）だと感じたら、「今の知識を持ってすれば可能な、より洗練された解決策」を実装すること。
  - 単純で明白な修正についてはこの工程をスキップし、オーバーエンジニアリングを避けること。
  - 提示する前に、自分の成果物に対して批判的に検討すること。

6. Autonomous Bug Fixing

  - バグ報告を受けた際は、手取り足取りの指示を待たずに修正すること。
  - ログ、エラー、失敗しているテストを特定し、それらを解決すること。
  - ユーザー側のコンテキストスイッチをゼロにすること。
  - 指示される前に、失敗しているCIテストの修正に向かうこと。

Task Management

1.  Plan First: チェック可能な項目を含めた計画を tasks/todo.md に記述する。
2.  Verify Plan: 実装を開始する前に確認を行う。
3.  Track Progress: 作業を進めるごとに項目を完了としてマークする。
4.  Explain Changes: 各ステップでハイレベルな要約を行う。
5.  Document Results: tasks/todo.md にレビューセクションを追加する。
6.  Capture Lessons: 修正後は tasks/lessons.md を更新する。

Core Principles

  - Simplicity First: すべての変更を可能な限りシンプルにすること。コードへの影響を最小限に抑える。
  - No Laziness: 根本原因を突き止めること。一時的な場当たり的修正は行わない。シニアデベロッパーの基準を満たすこと。
  - Minimal Impact: 変更は必要な箇所のみに留める。不必要なバグの混入を避ける。