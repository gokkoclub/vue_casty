# ã‚­ãƒ£ã‚¹ãƒ†ã‚£ãƒ³ã‚°ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ  - å®Œå…¨ä»•æ§˜æ›¸

**æ›´æ–°æ—¥:** 2026å¹´1æœˆ14æ—¥  
**ãƒãƒ¼ã‚¸ãƒ§ãƒ³:** 1.0

---

## ğŸ“‹ ç›®æ¬¡

1. [ã‚·ã‚¹ãƒ†ãƒ æ¦‚è¦](#1-ã‚·ã‚¹ãƒ†ãƒ æ¦‚è¦)
2. [æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯](#2-æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯)
3. [ç’°å¢ƒå¤‰æ•°](#3-ç’°å¢ƒå¤‰æ•°)
4. [èªè¨¼ã‚·ã‚¹ãƒ†ãƒ ](#4-èªè¨¼ã‚·ã‚¹ãƒ†ãƒ )
5. [ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«](#5-ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«)
6. [ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰API](#6-ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰api)
7. [ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰æ©Ÿèƒ½](#7-ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰æ©Ÿèƒ½)
8. [Slacké€£æº](#8-slacké€£æº)
9. [Googleã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼é€£æº](#9-googleã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼é€£æº)
10. [æ’®å½±é€£çµ¡DB](#10-æ’®å½±é€£çµ¡db)
11. [å¤–éƒ¨é€£æº](#11-å¤–éƒ¨é€£æº)

---

## 1. ã‚·ã‚¹ãƒ†ãƒ æ¦‚è¦

### 1.1 ç›®çš„
ã‚­ãƒ£ã‚¹ãƒ†ã‚£ãƒ³ã‚°æ¥­å‹™ã‚’åŠ¹ç‡åŒ–ã™ã‚‹ãŸã‚ã®Webãƒ™ãƒ¼ã‚¹ã®ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ã€‚ä»¥ä¸‹ã®æ©Ÿèƒ½ã‚’æä¾›ï¼š
- ã‚­ãƒ£ã‚¹ãƒˆæƒ…å ±ã®ç®¡ç†ã¨æ¤œç´¢
- æ’®å½±æ¡ˆä»¶ã¸ã®ã‚­ãƒ£ã‚¹ãƒˆå‰²ã‚Šå½“ã¦
- ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ç®¡ç†ï¼ˆä»®æŠ¼ã•ãˆâ†’æ±ºå®šâ†’NGç­‰ï¼‰
- Slacké€šçŸ¥ã«ã‚ˆã‚‹é–¢ä¿‚è€…ã¸ã®è‡ªå‹•é€£çµ¡
- Googleã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã¨ã®åŒæœŸ
- æ’®å½±é€£çµ¡æƒ…å ±ã®ç®¡ç†

### 1.2 ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ­ãƒ¼ãƒ«
| ãƒ­ãƒ¼ãƒ« | æ¨©é™ |
|--------|------|
| ç®¡ç†è€… | å…¨æ©Ÿèƒ½ã®åˆ©ç”¨ã€ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹å¤‰æ›´ã€å‰Šé™¤æ“ä½œ |
| ä¸€èˆ¬ãƒ¦ãƒ¼ã‚¶ãƒ¼ | é–²è¦§ã€ã‚ªãƒ¼ãƒ€ãƒ¼ä½œæˆï¼ˆã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹å¤‰æ›´ã¯åˆ¶é™ï¼‰ |

### 1.3 ã‚·ã‚¹ãƒ†ãƒ æ§‹æˆå›³
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚ ã‚­ãƒ£ã‚¹ãƒˆæ¤œç´¢ â”‚  â”‚ ã‚«ãƒ¼ãƒˆ/ã‚ªãƒ¼ãƒ€ãƒ¼â”‚  â”‚ ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ç®¡ç†â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚    FastAPI Backend      â”‚
              â”‚     (main.py)           â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                      â”‚                      â”‚
â”Œâ”€â”€â”€â”´â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”
â”‚ Slack â”‚           â”‚Google Sheetsâ”‚        â”‚   Calendar  â”‚
â”‚  API  â”‚           â”‚  (ãƒ‡ãƒ¼ã‚¿)    â”‚        â”‚     API     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”˜           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 2. æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯

### 2.1 ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰
| æŠ€è¡“ | ç”¨é€” |
|------|------|
| Python 3.12 | ãƒ©ãƒ³ã‚¿ã‚¤ãƒ  |
| FastAPI | Webãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ |
| Uvicorn | ASGIã‚µãƒ¼ãƒãƒ¼ |
| gspread / gspread_asyncio | Google Sheets API |
| slack_sdk | Slack API |
| Pydantic | ãƒªã‚¯ã‚¨ã‚¹ãƒˆ/ãƒ¬ã‚¹ãƒãƒ³ã‚¹æ¤œè¨¼ |

### 2.2 ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰
| æŠ€è¡“ | ç”¨é€” |
|------|------|
| Jinja2ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ | HTMLãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚° |
| Tailwind CSS | ã‚¹ã‚¿ã‚¤ãƒªãƒ³ã‚° |
| Google API Client (gapi) | Googleèªè¨¼/Sheets/Calendar |
| Vanilla JavaScript | ãƒ­ã‚¸ãƒƒã‚¯ |

### 2.3 å¤–éƒ¨ã‚µãƒ¼ãƒ“ã‚¹
| ã‚µãƒ¼ãƒ“ã‚¹ | ç”¨é€” |
|----------|------|
| Google Sheets | ãƒ‡ãƒ¼ã‚¿ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ï¼ˆã‚­ãƒ£ã‚¹ãƒˆä¸€è¦§ã€ã‚­ãƒ£ã‚¹ãƒ†ã‚£ãƒ³ã‚°ãƒªã‚¹ãƒˆã€æ’®å½±é€£çµ¡DBï¼‰ |
| Slack | é€šçŸ¥é€ä¿¡ |
| Google Calendar | æ’®å½±äºˆå®šã®ç®¡ç† |
| Notionï¼ˆGASçµŒç”±ï¼‰ | æ¡ˆä»¶æƒ…å ±ã®åŒæœŸ |
| Heroku | æœ¬ç•ªãƒ‡ãƒ—ãƒ­ã‚¤ |

---

## 3. ç’°å¢ƒå¤‰æ•°

### 3.1 Googleé–¢é€£
| å¤‰æ•°å | èª¬æ˜ |
|--------|------|
| `GOOGLE_CLIENT_ID` | OAuth ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆID |
| `GOOGLE_OAUTH_CLIENT_SECRET_JSON` | OAuth è¨­å®šJSON |
| `GOOGLE_SHEETS_CREDS_JSON` | ã‚µãƒ¼ãƒ“ã‚¹ã‚¢ã‚«ã‚¦ãƒ³ãƒˆèªè¨¼JSON |
| `SPREADSHEET_ID` | ãƒ¡ã‚¤ãƒ³ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆID |
| `SHOOTING_CONTACT_SHEET_ID` | æ’®å½±é€£çµ¡DBã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆID |
| `CALENDAR_ID_INTERNAL_HOLD` | å†…éƒ¨ã‚­ãƒ£ã‚¹ãƒˆç”¨ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ID |

### 3.2 Slacké–¢é€£
| å¤‰æ•°å | èª¬æ˜ |
|--------|------|
| `SLACK_BOT_TOKEN` | Bot User OAuth Token (xoxb-...) |
| `SLACK_DEFAULT_CHANNEL` | ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆé€šçŸ¥ãƒãƒ£ãƒ³ãƒãƒ«ID |
| `SLACK_CHANNEL_EXTERNAL` | å¤–éƒ¨æ¡ˆä»¶ç”¨ãƒãƒ£ãƒ³ãƒãƒ«ID |
| `SLACK_CHANNEL_TYPE_A` | ãƒ‘ã‚¿ãƒ¼ãƒ³Aç”¨ãƒãƒ£ãƒ³ãƒãƒ« |
| `SLACK_CHANNEL_TYPE_B` | ãƒ‘ã‚¿ãƒ¼ãƒ³Bç”¨ãƒãƒ£ãƒ³ãƒãƒ« |
| `SLACK_CHANNEL_TEST` | ãƒ†ã‚¹ãƒˆç”¨ãƒãƒ£ãƒ³ãƒãƒ« |
| `SLACK_MENTION_GROUP_ID` | ãƒ¡ãƒ³ã‚·ãƒ§ãƒ³å¯¾è±¡ã‚°ãƒ«ãƒ¼ãƒ—ID |

### 3.3 ãã®ä»–
| å¤‰æ•°å | èª¬æ˜ |
|--------|------|
| `GAS_ENDPOINT_URL` | Google Apps Script WebAppã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ |

---

## 4. èªè¨¼ã‚·ã‚¹ãƒ†ãƒ 

### 4.1 èªè¨¼ãƒ•ãƒ­ãƒ¼

```mermaid
sequenceDiagram
    participant User
    participant Frontend
    participant Backend
    participant Google

    User->>Frontend: ãƒ­ã‚°ã‚¤ãƒ³ãƒœã‚¿ãƒ³ã‚¯ãƒªãƒƒã‚¯
    Frontend->>Google: OAuthèªå¯ãƒªã‚¯ã‚¨ã‚¹ãƒˆ
    Google->>Frontend: èªå¯ã‚³ãƒ¼ãƒ‰
    Frontend->>Backend: POST /api/auth/login (code)
    Backend->>Google: ãƒˆãƒ¼ã‚¯ãƒ³äº¤æ›
    Google->>Backend: access_token, refresh_token
    Backend->>Frontend: Set-Cookie (refresh_token)
    Frontend->>Frontend: gapiåˆæœŸåŒ– (access_token)
```

### 4.2 ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ

#### POST `/api/auth/login`
- **å…¥åŠ›:** `{ "code": "èªå¯ã‚³ãƒ¼ãƒ‰" }`
- **å‡ºåŠ›:** `{ "access_token": "...", "refresh_token": "...", "expires_in": 3600 }`
- **Cookie:** `refresh_token` ã‚’ HttpOnly Cookie ã¨ã—ã¦è¨­å®š

#### GET `/api/auth/refresh`
- **å…¥åŠ›:** Cookieå†…ã® `refresh_token`
- **å‡ºåŠ›:** `{ "access_token": "...", "expires_in": 3600 }`

#### POST `/api/auth/logout`
- **å‡¦ç†:** `refresh_token` Cookie ã‚’å‰Šé™¤

### 4.3 æ¨©é™ç®¡ç†
ç®¡ç†è€…ã‹ã©ã†ã‹ã¯ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã§åˆ¤å®šï¼ˆãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ï¼‰:
```javascript
const ADMIN_EMAILS = ["admin1@example.com", "admin2@example.com"];
const isAdmin = ADMIN_EMAILS.includes(currentUser?.email);
```

---

## 5. ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«

### 5.1 Googleã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆæ§‹é€ 

#### ã‚·ãƒ¼ãƒˆ: ã‚­ãƒ£ã‚¹ãƒˆä¸€è¦§
| åˆ— | å†…å®¹ |
|----|------|
| A | ã‚­ãƒ£ã‚¹ãƒˆID (UUID) |
| B | åå‰ |
| C | ã‹ãª |
| D | ç”Ÿå¹´æœˆæ—¥ |
| E | æ€§åˆ¥ |
| F | æ‰€å±äº‹å‹™æ‰€ |
| G | å†…éƒ¨/å¤–éƒ¨ãƒ•ãƒ©ã‚° |
| H | å†™çœŸURL |
| I | ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ |
| J | Slack User ID |
| K | Instagram URL |
| L | TikTok URL |
| M | X (Twitter) URL |

#### ã‚·ãƒ¼ãƒˆ: ã‚­ãƒ£ã‚¹ãƒ†ã‚£ãƒ³ã‚°ãƒªã‚¹ãƒˆ
| åˆ— | å†…å®¹ |
|----|------|
| A | ã‚­ãƒ£ã‚¹ãƒ†ã‚£ãƒ³ã‚°ID (UUID) |
| B | ã‚¢ã‚«ã‚¦ãƒ³ãƒˆåï¼ˆãƒãƒ¼ãƒ /æ¡ˆä»¶åï¼‰ |
| C | æ¡ˆä»¶å |
| D | å½¹å |
| E | ã‚­ãƒ£ã‚¹ãƒˆID |
| F | ã‚­ãƒ£ã‚¹ãƒˆå |
| G | é–‹å§‹æ—¥ |
| H | çµ‚äº†æ—¥ |
| I | å„ªå…ˆé †ä½ |
| J | ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ |
| K | æ™‚é–“ç¯„å›² |
| L | Slackã‚¹ãƒ¬ãƒƒãƒ‰ID |
| M | Slackãƒ‘ãƒ¼ãƒãƒªãƒ³ã‚¯ |
| N | ãƒ¡ã‚¤ãƒ³/ã‚µãƒ–åŒºåˆ† |
| O | ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã‚¤ãƒ™ãƒ³ãƒˆID |
| P | æ¡ˆä»¶ID (Notionãƒšãƒ¼ã‚¸ID) |
| Q | æœ€çµ‚æ›´æ–°æ—¥æ™‚ |
| R | æ›´æ–°è€… |
| S | é‡‘é¡ |
| T | ã‚­ãƒ£ã‚¹ãƒˆã‚¿ã‚¤ãƒ—ï¼ˆå†…éƒ¨/å¤–éƒ¨ï¼‰ |
| U | ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ |
| V | ç™ºæ³¨æ›¸ID |
| W | æ§‹é€ ãƒ‡ãƒ¼ã‚¿ (JSON) |

### 5.2 Pydanticãƒ¢ãƒ‡ãƒ«

#### OrderItem
```python
class OrderItem(BaseModel):
    castingId: str
    roleName: str = ""
    castName: str
    rank: int
    note: str = ""
    projectName: str
    slack_user_id: Optional[str] = None
    conflictInfo: Optional[str] = None
    isInternal: bool = False
```

#### OrderCreatedPayload
```python
class OrderCreatedPayload(BaseModel):
    accountName: str
    projectName: str
    projectId: str
    dateRanges: List[str]
    orders: List[OrderItem]
    orderType: Literal["pattern_a", "pattern_b", "test"] = "test"
    ccString: Optional[str] = None
    slackThreadTs: Optional[str] = None
    isAdditionalOrder: bool = False
```

#### StatusUpdatePayload
```python
class StatusUpdatePayload(BaseModel):
    castingId: str
    newStatus: str
    castName: str
    slackThreadTs: Optional[str] = None
    slackPermalink: Optional[str] = None
    extraMessage: Optional[str] = None
    isInternal: Optional[bool] = False
    projectId: Optional[str] = None
    mainSub: Optional[str] = "ãã®ä»–"
    orderDetails: Optional[list] = None
```

#### SpecialOrderPayload
```python
class SpecialOrderPayload(BaseModel):
    orderType: Literal["external", "internal"]
    title: str
    dates: List[str]
    startTime: str
    endTime: str
    castIds: List[str]
    ordererEmail: str
```

---

## 6. ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰API

### 6.1 ã‚ªãƒ¼ãƒ€ãƒ¼é–¢é€£

#### POST `/api/notify/order_created`
**é€šå¸¸ã‚ªãƒ¼ãƒ€ãƒ¼ã®ä½œæˆ**

- **Content-Type:** `multipart/form-data`
- **ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿:**
  - `files`: PDFæ·»ä»˜ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆè¤‡æ•°å¯ï¼‰
  - `payload_str`: OrderCreatedPayload ã® JSONæ–‡å­—åˆ—

**å‡¦ç†ãƒ•ãƒ­ãƒ¼:**
1. Slacké€šçŸ¥é€ä¿¡ï¼ˆPDFæ·»ä»˜ or ãƒ†ã‚­ã‚¹ãƒˆã®ã¿ï¼‰
2. `ts`ï¼ˆã‚¹ãƒ¬ãƒƒãƒ‰IDï¼‰ã¨`permalink`ã‚’å–å¾—
3. ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã¨ã—ã¦ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã«è¿”å´
4. ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ãŒã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã«æ›¸ãè¾¼ã¿

**Slack tså–å¾—ãƒ­ã‚¸ãƒƒã‚¯ï¼ˆPDFæ™‚ï¼‰:**
1. `files_upload_v2` ã§PDFã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
2. `files.info` API ã§ shares ã‚’å–å¾—
3. shares ã‹ã‚‰ `ts` ã‚’æŠ½å‡º

---

#### POST `/api/notify/special_order`
**ç‰¹åˆ¥ã‚ªãƒ¼ãƒ€ãƒ¼ï¼ˆå¤–éƒ¨æ¡ˆä»¶/ç¤¾å†…ã‚¤ãƒ™ãƒ³ãƒˆï¼‰ã®ä½œæˆ**

- **å…¥åŠ›:** SpecialOrderPayload
- **å‡¦ç†:**
  1. Slacké€šçŸ¥é€ä¿¡
  2. ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã«ç›´æ¥æ›¸ãè¾¼ã¿ï¼ˆãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã§å®Ÿè¡Œï¼‰
  3. å†…éƒ¨ã‚­ãƒ£ã‚¹ãƒˆã®å ´åˆã€ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ç™»éŒ²ç”¨ãƒ‡ãƒ¼ã‚¿ã‚’è¿”å´
- **å‡ºåŠ›:** `{ ok: true, calendar_events: [...] }`

---

#### POST `/api/special_order/update`
**ç‰¹åˆ¥ã‚ªãƒ¼ãƒ€ãƒ¼ã®æ›´æ–°**

- **å…¥åŠ›:** SpecialOrderUpdatePayload
- **å‡¦ç†:**
  1. `slackThreadTs` ã§å®Œå…¨ä¸€è‡´æ¤œç´¢
  2. ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆæ›´æ–°
  3. Slackã‚¹ãƒ¬ãƒƒãƒ‰ã«æ›´æ–°é€šçŸ¥

---

#### POST `/api/special_order/delete`
**ç‰¹åˆ¥ã‚ªãƒ¼ãƒ€ãƒ¼ã®å‰Šé™¤**

- **å…¥åŠ›:** `{ slackThreadTs: string }`
- **å‡¦ç†:**
  1. åŒã˜ `slackThreadTs` ã‚’æŒã¤å…¨ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’æ¤œç´¢
  2. ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚’ã€Œå‰Šé™¤æ¸ˆã¿ã€ã«æ›´æ–°
  3. Slackã‚¹ãƒ¬ãƒƒãƒ‰ã«å‰Šé™¤é€šçŸ¥

---

#### POST `/api/order/delete`
**é€šå¸¸ã‚ªãƒ¼ãƒ€ãƒ¼ï¼ˆã‚­ãƒ£ã‚¹ãƒˆå˜ä½ï¼‰ã®å‰Šé™¤**

- **å…¥åŠ›:** `{ castingId: string, slackThreadTs: string }`
- **å‡¦ç†:**
  1. è©²å½“ãƒ¬ã‚³ãƒ¼ãƒ‰ã®ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚’ã€Œå‰Šé™¤æ¸ˆã¿ã€ã«æ›´æ–°
  2. Slackã‚¹ãƒ¬ãƒƒãƒ‰ã«å‰Šé™¤é€šçŸ¥
  3. `calendar_event_id` ã‚’è¿”å´ï¼ˆã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼å‰Šé™¤ã¯ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰å®Ÿè¡Œï¼‰

---

### 6.2 ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹æ›´æ–°

#### POST `/api/notify/status_update`
- **å…¥åŠ›:** StatusUpdatePayload
- **å‡¦ç†:**
  1. Slackã‚¹ãƒ¬ãƒƒãƒ‰ã«ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹å¤‰æ›´é€šçŸ¥
  2. ã€ŒOKã€ã¾ãŸã¯ã€Œæ±ºå®šã€ã®å ´åˆ:
     - GASçµŒç”±ã§Notionã«åŒæœŸï¼ˆãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ã‚¿ã‚¹ã‚¯ï¼‰
- **å‡ºåŠ›:** `{ ok: true }`

---

### 6.3 æ’®å½±é€£çµ¡DB

#### GET `/api/shooting_contact/list`
**æ’®å½±é€£çµ¡ãƒ‡ãƒ¼ã‚¿ã®å–å¾—**

- **å‡ºåŠ›:** å…¨ãƒ¬ã‚³ãƒ¼ãƒ‰ã®ãƒªã‚¹ãƒˆ

---

#### POST `/api/shooting_contact/add`
**æ’®å½±é€£çµ¡ãƒ¬ã‚³ãƒ¼ãƒ‰ã®è¿½åŠ **

- **é‡è¤‡ãƒã‚§ãƒƒã‚¯:** åŒä¸€ `castingId` ãŒå­˜åœ¨ã™ã‚‹å ´åˆã¯ã‚¹ã‚­ãƒƒãƒ—

---

#### POST `/api/shooting_contact/update`
**æ’®å½±é€£çµ¡ãƒ¬ã‚³ãƒ¼ãƒ‰ã®æ›´æ–°**

- **æ›´æ–°å¯èƒ½ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰:**
  - ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹
  - IN/OUTæ™‚é–“
  - å ´æ‰€ãƒ»ä½æ‰€
  - é‡‘é¡
  - ãƒ¡ã‚¤ã‚­ãƒ³ã‚°URL
  - æŠ•ç¨¿æ—¥

---

### 6.4 ãã®ä»–

#### GET `/api/sync/gas`
**GASãƒˆãƒªã‚¬ãƒ¼å‘¼ã³å‡ºã—**

- **ç”¨é€”:** æ’®å½±ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã®æ‰‹å‹•åŒæœŸ

---

## 7. ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰æ©Ÿèƒ½

### 7.1 ãƒ“ãƒ¥ãƒ¼æ§‹æˆ

| ãƒ“ãƒ¥ãƒ¼ | èª¬æ˜ |
|--------|------|
| `casting-view` | ã‚­ãƒ£ã‚¹ãƒˆæ¤œç´¢ãƒ»ã‚«ãƒ¼ãƒˆè¿½åŠ ç”»é¢ |
| `status-view` | ã‚­ãƒ£ã‚¹ãƒ†ã‚£ãƒ³ã‚°çŠ¶æ³ä¸€è¦§ |
| `shooting-contact-view` | æ’®å½±é€£çµ¡DBç®¡ç†ç”»é¢ |

---

### 7.2 ã‚­ãƒ£ã‚¹ãƒˆæ¤œç´¢ç”»é¢ (casting-view)

#### æ©Ÿèƒ½
- **ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°:** äº‹å‹™æ‰€ã€æ€§åˆ¥ã€å¹´é½¢ç¯„å›²
- **æ’®å½±æ—¥é¸æŠ:** Notionãƒšãƒ¼ã‚¸IDãƒ™ãƒ¼ã‚¹ã®æ’®å½±ä¸€è¦§ã‹ã‚‰é¸æŠ
- **ã‚­ãƒ£ã‚¹ãƒˆã‚«ãƒ¼ãƒ‰è¡¨ç¤º:**
  - å†™çœŸ
  - åå‰ãƒ»æ‰€å±
  - ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒãƒƒã‚¸ï¼ˆä»®æŠ¼ã•ãˆæ¸ˆã¿ã€æ±ºå®šæ¸ˆã¿ç­‰ï¼‰
  - NGçŠ¶æ…‹è¡¨ç¤º

#### é–¢é€£é–¢æ•°
- `loadAllData()`: å…¨ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿
- `displayAvailableCasts()`: ã‚­ãƒ£ã‚¹ãƒˆä¸€è¦§è¡¨ç¤º
- `getFilteredCasts()`: ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°å‡¦ç†

---

### 7.3 ã‚«ãƒ¼ãƒˆã‚·ã‚¹ãƒ†ãƒ 

#### çŠ¶æ…‹ç®¡ç†
```javascript
let cart = {};  // { castId: true } å½¢å¼
let cartProjects = [];  // æ¡ˆä»¶ãƒ»å½¹æƒ…å ±ã®é…åˆ—
let cartMeta = {
  account: '',
  notionUrl: '',
  projectNames: [],
  combinedProjectNames: [],
  pdfFiles: []
};
```

#### ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼

**Step 1: ã‚«ãƒ¼ãƒˆå†…å®¹ç¢ºèª**
1. ã‚«ãƒ¼ãƒˆã«è¿½åŠ ã•ã‚ŒãŸã‚­ãƒ£ã‚¹ãƒˆã‚’è¡¨ç¤º
2. æ¡ˆä»¶æƒ…å ±ã‚’å…¥åŠ›ï¼ˆNotionURLã€æ¡ˆä»¶åï¼‰
3. PDFæ·»ä»˜ï¼ˆä»»æ„ï¼‰

**Step 2: å½¹å‰²å‰²ã‚Šå½“ã¦**
1. ãƒ‰ãƒ©ãƒƒã‚°ï¼†ãƒ‰ãƒ­ãƒƒãƒ—ã§ã‚­ãƒ£ã‚¹ãƒˆã‚’å½¹ã«å‰²ã‚Šå½“ã¦
2. å½¹åã€ã‚¿ã‚¤ãƒ—ï¼ˆãƒ¡ã‚¤ãƒ³/ã‚µãƒ–ï¼‰ã€å‚™è€ƒã‚’å…¥åŠ›
3. è¤‡æ•°æ¡ˆä»¶å¯¾å¿œï¼ˆè¿½åŠ ãƒœã‚¿ãƒ³ï¼‰

**Step 3: ç¢ºèªãƒ»é€ä¿¡**
1. å†…å®¹ç¢ºèª
2. æ—¥ç¨‹ç¢ºèªï¼ˆè¡çªè­¦å‘Šè¡¨ç¤ºï¼‰
3. ä»®æŠ¼ã•ãˆç¢ºèª â†’ é€ä¿¡

#### é–¢é€£é–¢æ•°
- `addToCart(castId)`: ã‚«ãƒ¼ãƒˆè¿½åŠ 
- `renderCartStep1(modal)`: Step 1è¡¨ç¤º
- `renderCartStep2(modal)`: Step 2è¡¨ç¤º
- `renderConfirmationModal()`: ç¢ºèªãƒ¢ãƒ¼ãƒ€ãƒ«
- `confirmProvisionalBookings(data)`: ä»®æŠ¼ã•ãˆå‡¦ç†
- `processNewOrder(data)`: Slacké€šçŸ¥ + ã‚·ãƒ¼ãƒˆæ›¸ãè¾¼ã¿

---

### 7.4 ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ç®¡ç†ç”»é¢ (status-view)

#### æ©Ÿèƒ½
- **æœˆåˆ¥è¡¨ç¤º:** æœˆã”ã¨ã®ã‚­ãƒ£ã‚¹ãƒ†ã‚£ãƒ³ã‚°çŠ¶æ³
- **ã‚¿ãƒ–åˆ‡ã‚Šæ›¿ãˆ:**
  - `casting`: é€šå¸¸ã‚ªãƒ¼ãƒ€ãƒ¼ï¼ˆå†…éƒ¨/å¤–éƒ¨ï¼‰
  - `special`: ç‰¹åˆ¥ã‚ªãƒ¼ãƒ€ãƒ¼ï¼ˆå¤–éƒ¨æ¡ˆä»¶/ç¤¾å†…ã‚¤ãƒ™ãƒ³ãƒˆï¼‰
- **ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹å¤‰æ›´:** ãƒ¢ãƒ¼ãƒ€ãƒ«ã§ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹æ›´æ–°
- **è¿½åŠ ã‚ªãƒ¼ãƒ€ãƒ¼:** æ—¢å­˜ã‚¹ãƒ¬ãƒƒãƒ‰ã¸ã®è¿½åŠ 

#### ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ç¨®é¡
| ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ | è‰² | èª¬æ˜ |
|------------|----|----|
| ä»®æŠ¼ã•ãˆ | é»„è‰² | æ—¥ç¨‹ä»®ç¢ºä¿ |
| ä»®ã‚­ãƒ£ã‚¹ãƒ†ã‚£ãƒ³ã‚° | é’è‰² | å†…éƒ¨ã‚­ãƒ£ã‚¹ãƒˆã®ä»®ç¢ºå®š |
| æ‰“è¨ºä¸­ | ã‚°ãƒ¬ãƒ¼ | äº‹å‹™æ‰€ã«æ‰“è¨ºä¸­ |
| ã‚ªãƒ¼ãƒ€ãƒ¼å¾…ã¡ | ã‚ªãƒ¬ãƒ³ã‚¸ | ã‚ªãƒ¼ãƒ€ãƒ¼ç™ºè¡Œå¾…ã¡ |
| OK | ç·‘ | äº‹å‹™æ‰€ã‹ã‚‰OKå›ç­” |
| æ±ºå®š | ç·‘+å¤ªå­— | æ­£å¼æ±ºå®š |
| NG | èµ¤ | ä¸å¯ |
| ã‚­ãƒ£ãƒ³ã‚»ãƒ« | èµ¤+æ‰“æ¶ˆã—ç·š | ã‚­ãƒ£ãƒ³ã‚»ãƒ« |
| å‰Šé™¤æ¸ˆã¿ | ã‚°ãƒ¬ãƒ¼ï¼ˆéè¡¨ç¤ºï¼‰ | è«–ç†å‰Šé™¤ |

#### é–¢é€£é–¢æ•°
- `renderCastingStatusView(refresh)`: ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ä¸€è¦§è¡¨ç¤º
- `changeCastingStatus(castingId, newStatus, extraArg)`: ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹å¤‰æ›´
- `postStatusUpdateToSlack(rec, newStatus, extraMessage)`: Slacké€šçŸ¥
- `openStatusQuickModal(castingId)`: ã‚¯ã‚¤ãƒƒã‚¯æ“ä½œãƒ¢ãƒ¼ãƒ€ãƒ«
- `deleteCastingOrder(castingId)`: ã‚ªãƒ¼ãƒ€ãƒ¼å‰Šé™¤

---

### 7.5 ç‰¹åˆ¥ã‚ªãƒ¼ãƒ€ãƒ¼æ©Ÿèƒ½

#### å¤–éƒ¨æ¡ˆä»¶ (external)
- å¤–éƒ¨ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‹ã‚‰ã®æ¡ˆä»¶
- å¤–éƒ¨ç”¨Slackãƒãƒ£ãƒ³ãƒãƒ«ã«é€šçŸ¥
- æ’®å½±é€£çµ¡DBã«ã¯è¿½åŠ ã•ã‚Œãªã„

#### ç¤¾å†…ã‚¤ãƒ™ãƒ³ãƒˆ (internal)
- ç¤¾å†…ã‚¤ãƒ™ãƒ³ãƒˆãƒ»æ’®å½±
- ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆSlackãƒãƒ£ãƒ³ãƒãƒ«ã«é€šçŸ¥
- å†…éƒ¨ã‚­ãƒ£ã‚¹ãƒˆã¯ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ç™»éŒ²å¯¾è±¡

#### é–¢é€£é–¢æ•°
- `openSpecialOrderModal(type)`: ç‰¹åˆ¥ã‚ªãƒ¼ãƒ€ãƒ¼ãƒ¢ãƒ¼ãƒ€ãƒ«
- `openEditSpecialOrderModal(slackThreadTs)`: ç·¨é›†ãƒ¢ãƒ¼ãƒ€ãƒ«
- `saveEditSpecialOrder()`: ç·¨é›†ä¿å­˜
- `confirmDeleteSpecialOrder()`: å‰Šé™¤ç¢ºèª
- `executeDeleteSpecialOrder()`: å‰Šé™¤å®Ÿè¡Œ

---

### 7.6 æ’®å½±é€£çµ¡DB (shooting-contact-view)

#### ã‚¿ãƒ–æ§‹æˆ
| ã‚¿ãƒ– | èª¬æ˜ |
|------|------|
| é¦™ç›¤é€£çµ¡å¾…ã¡ | IN/OUTæ™‚é–“ãƒ»å ´æ‰€ã®é€£çµ¡å¾…ã¡ |
| ç™ºæ³¨æ›¸é€ä¿¡å¾…ã¡ | ç™ºæ³¨æ›¸ä½œæˆãƒ»é€ä¿¡å¾…ã¡ |
| ãƒ¡ã‚¤ã‚­ãƒ³ã‚°å…±æœ‰å¾…ã¡ | ãƒ¡ã‚¤ã‚­ãƒ³ã‚°URLå…±æœ‰å¾…ã¡ |
| æŠ•ç¨¿æ—¥é€£çµ¡å¾…ã¡ | SNSæŠ•ç¨¿æ—¥é€£çµ¡å¾…ã¡ |
| å®Œäº† | å…¨ãƒ•ãƒ­ãƒ¼å®Œäº† |

#### æ©Ÿèƒ½
- æ—¥ä»˜ãƒ»æ¡ˆä»¶åˆ¥ã‚¢ã‚³ãƒ¼ãƒ‡ã‚£ã‚ªãƒ³è¡¨ç¤º
- IN/OUTæ™‚é–“ãƒ»å ´æ‰€ãƒ»é‡‘é¡ã®ç·¨é›†
- ãƒ¡ãƒ¼ãƒ«ä½œæˆï¼ˆãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆç”Ÿæˆï¼‰
- ç™ºæ³¨æ›¸PDFç”Ÿæˆ
- ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹æ›´æ–°

#### é–¢é€£é–¢æ•°
- `loadShootingContactPage()`: ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿
- `renderProjectTable(items)`: ãƒ†ãƒ¼ãƒ–ãƒ«è¡¨ç¤º
- `saveShootingRow(castingId, btn)`: è¡Œãƒ‡ãƒ¼ã‚¿ä¿å­˜
- `openShootMailModal(castingId)`: ãƒ¡ãƒ¼ãƒ«ä½œæˆãƒ¢ãƒ¼ãƒ€ãƒ«
- `openOrderDocModal(castingId)`: ç™ºæ³¨æ›¸ãƒ¢ãƒ¼ãƒ€ãƒ«
- `generatePDFFromData(data)`: PDFç”Ÿæˆ

---

## 8. Slacké€£æº

### 8.1 å¿…è¦ãªã‚¹ã‚³ãƒ¼ãƒ—
| ã‚¹ã‚³ãƒ¼ãƒ— | ç”¨é€” |
|----------|------|
| `chat:write` | ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸é€ä¿¡ |
| `files:write` | ãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ |
| `files:read` | ãƒ•ã‚¡ã‚¤ãƒ«æƒ…å ±å–å¾—ï¼ˆtså–å¾—ç”¨ï¼‰ |
| `channels:read` | ãƒãƒ£ãƒ³ãƒãƒ«æƒ…å ±å–å¾— |
| `channels:history` | ãƒãƒ£ãƒ³ãƒãƒ«å±¥æ­´å–å¾— |

### 8.2 ãƒãƒ£ãƒ³ãƒãƒ«æŒ¯ã‚Šåˆ†ã‘
```python
def pick_channel(order_type: str):
    if order_type == "pattern_a":
        return SLACK_CHANNEL_TYPE_A
    elif order_type == "pattern_b":
        return SLACK_CHANNEL_TYPE_B
    elif order_type == "test":
        return SLACK_CHANNEL_TEST
    elif order_type == "external":
        return SLACK_CHANNEL_EXTERNAL
    else:
        return SLACK_DEFAULT_CHANNEL
```

### 8.3 ã‚¹ãƒ¬ãƒƒãƒ‰ID (ts) ã®ä»•æ§˜

#### å½¢å¼
- **å®Œå…¨å½¢å¼:** `1768379900.553249` (10æ¡.6æ¡)
- **Permalinkå†…:** `p1768379900553249` (16æ¡é€£çµ)

#### ä¿å­˜
- ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã«ã¯ã‚·ãƒ³ã‚°ãƒ«ã‚¯ã‚©ãƒ¼ãƒˆä»˜ãã§ä¿å­˜
- ä¾‹: `'1768379900.553249`
- ã“ã‚Œã«ã‚ˆã‚Šæ•°å€¤å¤‰æ›ã«ã‚ˆã‚‹ç²¾åº¦å–ªå¤±ã‚’é˜²æ­¢

#### æ¤œç´¢
- å®Œå…¨ä¸€è‡´ã§æ¤œç´¢
- ã‚·ãƒ³ã‚°ãƒ«ã‚¯ã‚©ãƒ¼ãƒˆã¯æ¤œç´¢æ™‚ã«é™¤å»

---

## 9. Googleã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼é€£æº

### 9.1 å¯¾è±¡
- **å†…éƒ¨ã‚­ãƒ£ã‚¹ãƒˆã®ã¿**: ä»®æŠ¼ã•ãˆ/æ±ºå®šæ™‚ã«ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ç™»éŒ²

### 9.2 ã‚¤ãƒ™ãƒ³ãƒˆå½¢å¼
| ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ | å†…å®¹ |
|------------|------|
| summary | `[ä»®] ã‚­ãƒ£ã‚¹ãƒˆå / æ¡ˆä»¶å` ã¾ãŸã¯ `ã‚­ãƒ£ã‚¹ãƒˆå / æ¡ˆä»¶å` |
| description | è©³ç´°æƒ…å ±ï¼ˆæ¡ˆä»¶åã€å½¹åç­‰ï¼‰ |
| start/end | æ’®å½±æ—¥æ™‚ï¼ˆçµ‚æ—¥ or æ™‚é–“æŒ‡å®šï¼‰ |

### 9.3 å‡¦ç†
```javascript
// ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ç™»éŒ²
async function createInternalHoldEvents(events) {
  for (const ev of events) {
    const resource = {
      summary: ev.usePrefix ? `[ä»®] ${ev.castName} / ${ev.projectName}` : `${ev.castName} / ${ev.projectName}`,
      description: `æ¡ˆä»¶: ${ev.projectName}\nå½¹å: ${ev.roleName}`,
      start: { date: ev.date },  // çµ‚æ—¥ã‚¤ãƒ™ãƒ³ãƒˆ
      end: { date: nextDay(ev.date) }
    };
    
    const response = await gapi.client.calendar.events.insert({
      calendarId: CALENDAR_ID,
      resource: resource
    });
    
    // ã‚¤ãƒ™ãƒ³ãƒˆIDã‚’ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã«ä¿å­˜
    await updateSheet(ev.rowNumber, response.result.id);
  }
}
```

### 9.4 ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹å¤‰æ›´æ™‚ã®å‡¦ç†
| æ–°ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ | ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼å‡¦ç† |
|--------------|----------------|
| OK/æ±ºå®š | `[ä»®]` ãƒ—ãƒ¬ãƒ•ã‚£ãƒƒã‚¯ã‚¹ã‚’å‰Šé™¤ |
| NG/ã‚­ãƒ£ãƒ³ã‚»ãƒ« | ã‚¤ãƒ™ãƒ³ãƒˆå‰Šé™¤ |
| å‰Šé™¤æ¸ˆã¿ | ã‚¤ãƒ™ãƒ³ãƒˆå‰Šé™¤ï¼ˆãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰å®Ÿè¡Œï¼‰ |

---

## 10. æ’®å½±é€£çµ¡DB

### 10.1 ãƒ‡ãƒ¼ã‚¿è¿½åŠ æ¡ä»¶
- ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãŒã€Œæ±ºå®šã€ã¾ãŸã¯ã€ŒOKã€ã«å¤‰æ›´ã•ã‚ŒãŸå ´åˆ
- **å¤–éƒ¨ã‚­ãƒ£ã‚¹ãƒˆã®ã¿**ï¼ˆå†…éƒ¨ã‚­ãƒ£ã‚¹ãƒˆã¯å¯¾è±¡å¤–ï¼‰
- é‡è¤‡ãƒã‚§ãƒƒã‚¯: åŒä¸€ `castingId` ãŒå­˜åœ¨ã™ã‚‹å ´åˆã¯ã‚¹ã‚­ãƒƒãƒ—

### 10.2 ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒ•ãƒ­ãƒ¼
```
é¦™ç›¤é€£çµ¡å¾…ã¡ â†’ ç™ºæ³¨æ›¸é€ä¿¡å¾…ã¡ â†’ ãƒ¡ã‚¤ã‚­ãƒ³ã‚°å…±æœ‰å¾…ã¡ â†’ æŠ•ç¨¿æ—¥é€£çµ¡å¾…ã¡ â†’ å®Œäº†
```

### 10.3 ãƒ¡ãƒ¼ãƒ«ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ
`openShootMailModal()` ã§è‡ªå‹•ç”Ÿæˆ:
- æ’®å½±æ—¥æ™‚
- å ´æ‰€ãƒ»ä½æ‰€
- å ±é…¬é‡‘é¡
- æŒ¯è¾¼å…ˆæƒ…å ±
- ãƒ¡ã‚¤ã‚­ãƒ³ã‚°URL
- æŠ•ç¨¿æ¡ä»¶

---

## 11. å¤–éƒ¨é€£æº

### 11.1 Notioné€£æºï¼ˆGASçµŒç”±ï¼‰

#### åŒæœŸãƒˆãƒªã‚¬ãƒ¼
- ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãŒã€ŒOKã€ã¾ãŸã¯ã€Œæ±ºå®šã€ã«å¤‰æ›´
- ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ã‚¿ã‚¹ã‚¯ã§å®Ÿè¡Œ

#### åŒæœŸãƒ‡ãƒ¼ã‚¿
```python
async def sync_to_notion_via_gas(payload):
    if not GAS_ENDPOINT_URL:
        return
    
    async with httpx.AsyncClient() as client:
        await client.post(
            GAS_ENDPOINT_URL,
            json={
                "action": "syncToNotion",
                "projectId": payload.projectId,
                "castName": payload.castName,
                "status": payload.newStatus,
                "mainSub": payload.mainSub
            }
        )
```

### 11.2 æ’®å½±ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«åŒæœŸ

#### æ‰‹å‹•åŒæœŸ
```javascript
async function syncShootingSchedule(btn, syncType) {
  const res = await fetch(`/api/sync/gas?type=${syncType}`);
  // GASçµŒç”±ã§æ’®å½±ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’å–å¾—ãƒ»æ›´æ–°
}
```

---

## ä»˜éŒ²A: ãƒ•ã‚¡ã‚¤ãƒ«æ§‹æˆ

```
casting-management-system-v1/
â”œâ”€â”€ main.py                 # FastAPIãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰
â”œâ”€â”€ templates/
â”‚   â””â”€â”€ index.html          # ãƒ¡ã‚¤ãƒ³ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰
â”œâ”€â”€ docs/                   # ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
â”œâ”€â”€ requirements.txt        # Pythonä¾å­˜é–¢ä¿‚
â”œâ”€â”€ Procfile                # Herokuãƒ‡ãƒ—ãƒ­ã‚¤è¨­å®š
â”œâ”€â”€ .env                    # ç’°å¢ƒå¤‰æ•°ï¼ˆgitignoreå¯¾è±¡ï¼‰
â””â”€â”€ client_secret.json      # OAuthè¨­å®šï¼ˆgitignoreå¯¾è±¡ï¼‰
```

---

## ä»˜éŒ²B: ä¸»è¦é–¢æ•°ä¸€è¦§

### ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ (main.py)

| é–¢æ•°å | è¡Œ | èª¬æ˜ |
|--------|----|----|
| `get_creds()` | 142-161 | Googleèªè¨¼æƒ…å ±å–å¾— |
| `pick_channel()` | 180-183 | Slackãƒãƒ£ãƒ³ãƒãƒ«æŒ¯ã‚Šåˆ†ã‘ |
| `build_order_text()` | 185-295 | ã‚ªãƒ¼ãƒ€ãƒ¼é€šçŸ¥ãƒ†ã‚­ã‚¹ãƒˆç”Ÿæˆ |
| `auth_login()` | 335-367 | ãƒ­ã‚°ã‚¤ãƒ³å‡¦ç† |
| `notify_order_created()` | 415-558 | é€šå¸¸ã‚ªãƒ¼ãƒ€ãƒ¼é€šçŸ¥ |
| `notify_special_order()` | 561-754 | ç‰¹åˆ¥ã‚ªãƒ¼ãƒ€ãƒ¼é€šçŸ¥ |
| `notify_status_update()` | 757-795 | ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹æ›´æ–°é€šçŸ¥ |
| `update_special_order()` | 1037-1184 | ç‰¹åˆ¥ã‚ªãƒ¼ãƒ€ãƒ¼æ›´æ–° |
| `delete_special_order()` | 1186-1246 | ç‰¹åˆ¥ã‚ªãƒ¼ãƒ€ãƒ¼å‰Šé™¤ |
| `delete_order()` | 1248-1310 | é€šå¸¸ã‚ªãƒ¼ãƒ€ãƒ¼å‰Šé™¤ |

### ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ (index.html)

| é–¢æ•°å | èª¬æ˜ |
|--------|----|
| `loadAllData()` | å…¨ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿ |
| `displayAvailableCasts()` | ã‚­ãƒ£ã‚¹ãƒˆä¸€è¦§è¡¨ç¤º |
| `renderCastingStatusView()` | ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ç”»é¢è¡¨ç¤º |
| `changeCastingStatus()` | ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹å¤‰æ›´å‡¦ç† |
| `confirmProvisionalBookings()` | ä»®æŠ¼ã•ãˆç¢ºèªãƒ»å®Ÿè¡Œ |
| `processNewOrder()` | ã‚ªãƒ¼ãƒ€ãƒ¼é€ä¿¡ |
| `createInternalHoldEvents()` | ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã‚¤ãƒ™ãƒ³ãƒˆä½œæˆ |
| `loadShootingContactPage()` | æ’®å½±é€£çµ¡DBèª­ã¿è¾¼ã¿ |
| `openShootMailModal()` | ãƒ¡ãƒ¼ãƒ«ä½œæˆãƒ¢ãƒ¼ãƒ€ãƒ« |
| `generatePDFFromData()` | PDFç”Ÿæˆ |

---

**End of Document**
